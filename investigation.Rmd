---
title: "IDS investigation worksheet"
author: "by Team-Name: User1, User2, User3, User4 & User5"
date: "`r Sys.Date()`"
output: html_document
---

**Note:** You can use this file as you 'working document' where you can try out various investigation ideas and keep notes about your findings. How you use and structure this file is up to you. It is recommended that you keep notes about what you are investigating and what you find as this will make the process of creating your presentation and report easier. Please note that you _do not_ need to submit this file as part of your group project.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load-lib, message = FALSE}
library(tidyverse)
library(readr)
library(dplyr)
library(janitor)




```


```{r load-data}
prison_pop_by_crime_2002_2015 <- read_csv("data/prison_pop_by_crime_2002_2015.csv", 
                                                  col_types = cols(...32 = col_skip(), 
                                                                   ...33 = col_skip(), ...34 = col_skip(), 
                                                                   `30-Jun-02` = col_number(), `30-Jun-03` = col_number(), 
                                                                   `30-Jun-04` = col_number(), `30-Jun-05` = col_number(), 
                                                                   `30-Jun-06` = col_number(), `30-Jun-07` = col_number(), 
                                                                   `30-Jun-08` = col_number(), `30-Jun-09` = col_number(), 
                                                                   `30-Jun-09(1)` = col_number(), `30-Jun-10` = col_number(), 
                                                                   `30-Sep-10` = col_number(), `31-Dec-10` = col_number(), 
                                                                   `31-Mar-11` = col_number(), `30-Jun-11` = col_number(), 
                                                                   `30-Sep-11` = col_number(), `31-Dec-11` = col_number(), 
                                                                   `31-Mar-12` = col_number(), `30-Jun-12` = col_number(), 
                                                                   `30-Sep-12` = col_number(), `31-Dec-12` = col_number(), 
                                                                   `31-Mar-13` = col_number(), `30-Jun-13` = col_number(), 
                                                                   `30-Sep-13` = col_number(), `31-Dec-13` = col_number(), 
                                                                   `31-Mar-14` = col_number(), `30-Jun-14` = col_number(), 
                                                                   `30-Sep-14` = col_number(), `31-Dec-14` = col_number(), 
                                                                   `31-Mar-15` = col_number(), `30-Jun-15` = col_number()), 
                                                  skip = 1)
View(prison_pop_by_crime_2002_2015)


prison_pop_by_crime_2015_2023 <- read_csv("data/prison_pop_by_crime_2015_2023.csv", 
                                          col_types = cols(`30-Jun-15` = col_number(), 
                                                           `30-Sep-15` = col_number(), `31-Dec-15` = col_number(), 
                                                           `31-Mar-16` = col_number(), `30-Jun-16` = col_number(), 
                                                           `30-Sep-16` = col_number(), `31-Dec-16` = col_number(), 
                                                           `31-Mar-17` = col_number(), `30-Jun-17` = col_number(), 
                                                           `30-Sep-17` = col_number(), `31-Dec-17` = col_number(), 
                                                           `31-Mar-18` = col_number(), `30-Jun-18` = col_number(), 
                                                           `30-Sep-18` = col_number(), `31-Dec-18` = col_number(), 
                                                           `31-Mar-19` = col_number(), `30-Jun-19` = col_number(), 
                                                           `30-Sep-19` = col_number(), `31-Dec-19` = col_number(), 
                                                           `31-Mar-20` = col_number(), `30-Jun-20` = col_number(), 
                                                           `30-Sep-20` = col_number(), `31-Dec-20` = col_number(), 
                                                           `31-Mar-21` = col_number(), `30-Jun-21` = col_number(), 
                                                           `30-Sep-21` = col_number(), `31-Dec-21` = col_number(), 
                                                           `31-Mar-22` = col_number(), `30-Jun-22` = col_number(), 
                                                           `30-Sep-22` = col_number(), `31-Dec-22` = col_number(), 
                                                           `31-Mar-23` = col_number(), `30-Jun-23` = col_number()), 
                                          skip = 1)
view(prison_pop_by_crime_2015_2023)



#SELECTING DATA WANTED
earliercrimes <- prison_pop_by_crime_2002_2015 %>% 
  slice(2:11)
view(earliercrimes)

latercrimes <- prison_pop_by_crime_2015_2023 %>% 
  slice(2:14)
view(latercrimes)

# removing apare rows
earliercrimes <- earliercrimes %>% 
  select("...1" | (starts_with("30-Jun"))) %>% 
  select(-"30-Jun-09(1)")

latercrimes <- latercrimes %>% 
  select("...1" | (starts_with("30-Jun")))



#pivotting earlier data
earlierpivoted <- (earliercrimes %>% 
    pivot_longer(
      cols = c(-"...1"),
      names_to = 'date',
      values_to = "numconvicts"
    )) %>%
  pivot_wider(
    names_from = "...1",
    values_from = "numconvicts"
  )

earlierpivoted <- clean_names(earlierpivoted)

#pivoting later data
laterpivoted <- (latercrimes %>% 
                   pivot_longer(
                     cols = c(-"...1"),
                     names_to = 'date',
                     values_to = "numconvicts"
                   )) %>%
  pivot_wider(
    names_from = "...1",
    values_from = "numconvicts")

laterpivoted <- clean_names(laterpivoted)



#grouping crimes together
earlierpivotedgrouped <- earlierpivoted %>%
  mutate(
    theft_offences = (burglary + theft_and_handling),
    fraud_offences = fraud_and_forgery
  ) %>% 
  select(-"burglary", -"theft_and_handling", -"fraud_and_forgery")



laterpivotedgrouped <- laterpivoted %>% 
  mutate(
    motoring_offences = summary_non_motoring,
    other_offences = criminal_damage_and_arson + possession_of_weapons 
    + miscellaneous_crimes_against_society + summary_non_motoring + public_order_offences
  ) %>% 
  select(-"summary_non_motoring", -"criminal_damage_and_arson", -"possession_of_weapons",
         -"miscellaneous_crimes_against_society", -"summary_non_motoring", -"public_order_offences")

view(laterpivotedgrouped)



```


